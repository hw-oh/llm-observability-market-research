<script>
(function() {
  var TOKEN = 'weave-intel-2026';
  var params = new URLSearchParams(window.location.search);
  var t = params.get('token');
  if (t) {
    sessionStorage.setItem('_intel_token', t);
  }
  var stored = sessionStorage.getItem('_intel_token');
  if (stored !== TOKEN) {
    document.documentElement.innerHTML = '<body style="display:flex;align-items:center;justify-content:center;height:100vh;font-family:sans-serif;color:#666"><h2>Access denied. Valid token required.</h2></body>';
    throw new Error('unauthorized');
  }
})();
</script>
<style>
.top-nav {
  position: fixed; top: 12px; z-index: 1000;
  background: rgba(255,255,255,0.95); border: 1px solid #ddd;
  border-radius: 6px; padding: 4px 10px; font-size: 14px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.home-btn { left: 16px; }
.home-btn a { text-decoration: none; color: #1e6bb8; }
.home-btn a:hover { text-decoration: underline; }
.lang-switcher { right: 16px; }
.lang-switcher a { text-decoration: none; color: #1e6bb8; padding: 0 4px; }
.lang-switcher a:hover { text-decoration: underline; }
.lang-switcher .lang-active { font-weight: bold; color: #333; padding: 0 4px; }
</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
  var baseUrl = '{{ site.baseurl | default: "" }}';
  var path = window.location.pathname;
  var rel = path.startsWith(baseUrl) ? path.substring(baseUrl.length) : path;

  var lang = 'en', content = rel;
  if (rel.startsWith('/ko/')) { lang = 'ko'; content = rel.substring(3); }
  else if (rel.startsWith('/ja/')) { lang = 'ja'; content = rel.substring(3); }
  if (!content.startsWith('/')) content = '/' + content;

  // Home button (top-left)
  var homeUrl = lang === 'en' ? baseUrl + '/' : baseUrl + '/' + lang + '/';
  var homeEl = document.createElement('div');
  homeEl.className = 'top-nav home-btn';
  homeEl.innerHTML = '<a href="' + homeUrl + '">\uD83C\uDFE0 Home</a>';
  document.body.insertBefore(homeEl, document.body.firstChild);

  // Language switcher (top-right)
  var urls = { EN: baseUrl + content, KO: baseUrl + '/ko' + content, JA: baseUrl + '/ja' + content };
  var langEl = document.createElement('div');
  langEl.className = 'top-nav lang-switcher';
  langEl.innerHTML = Object.keys(urls).map(function(l) {
    return l.toLowerCase() === lang
      ? '<span class="lang-active">' + l + '</span>'
      : '<a href="' + urls[l] + '">' + l + '</a>';
  }).join(' | ');
  document.body.insertBefore(langEl, document.body.firstChild);
});
</script>
